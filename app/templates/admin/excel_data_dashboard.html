{% extends "base.html" %}

{% block breadcrumb %}
<a href="/admin/">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a> â€º <span>Ø¨ÙŠØ§Ù†Ø§Øª Excel</span>
{% endblock %}

{% block content %}

<style>
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }
  
  .stat-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(102, 126, 234, 0.4);
  }
  
  .stat-card h3 {
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 10px;
    opacity: 0.9;
  }
  
  .stat-value {
    font-size: 2.5rem;
    font-weight: 800;
    margin: 0;
  }
  
  .stat-card.warning {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  }
  
  .stat-card.success {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  }
  
  .stat-card.info {
    background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
  }
  
  .table-section {
    background: white;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  
  .table-section h3 {
    color: #0e6a74;
    margin-bottom: 15px;
    font-weight: 700;
  }
  
  .data-table {
    width: 100%;
    border-collapse: collapse;
  }
  
  .data-table thead {
    background: #f0f4f8;
    border-bottom: 2px solid #0e6a74;
  }
  
  .data-table th {
    padding: 12px;
    text-align: right;
    color: #0e6a74;
    font-weight: 600;
  }
  
  .data-table td {
    padding: 12px;
    border-bottom: 1px solid #e6f0f2;
  }
  
  .data-table tbody tr:hover {
    background: #f7fbfc;
  }
  
  .badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
  }
  
  .badge-active {
    background: #d1fae5;
    color: #065f46;
  }
  
  .badge-inactive {
    background: #fee2e2;
    color: #991b1b;
  }
  
  .badge-warning {
    background: #fef3c7;
    color: #92400e;
  }
  
  .empty-message {
    text-align: center;
    color: #6b7280;
    padding: 20px;
  }
  
  .dashboard-title {
    color: #0e6a74;
    font-size: 1.8rem;
    font-weight: 800;
    margin-bottom: 30px;
  }
</style>

<div class="dashboard-title">ğŸ“Š Ù„ÙˆØ­Ø© Ø¨ÙŠØ§Ù†Ø§Øª Excel Ø§Ù„Ø´Ø§Ù…Ù„Ø©</div>


<div class="stats-grid">
  <div class="stat-card success">
    <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ¯Ø±Ø¨ÙŠÙ†</h3>
    <p class="stat-value">{{ stats.total_students|int }}</p>
  </div>
  
  <div class="stat-card info">
    <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©</h3>
    <p class="stat-value">{{ stats.total_drugs|int }}</p>
  </div>
  
  <div class="stat-card success">
    <h3>Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù†Ø´Ø·Ø©</h3>
    <p class="stat-value">{{ stats.total_active_drugs|int }}</p>
  </div>
  
  {% if stats.total_low_stock_drugs > 0 %}
  <div class="stat-card warning">
    <h3>âš ï¸ Ø£Ø¯ÙˆÙŠØ© Ø¨Ù…Ø®Ø²ÙˆÙ† Ù…Ù†Ø®ÙØ¶</h3>
    <p class="stat-value">{{ stats.total_low_stock_drugs|int }}</p>
  </div>
  {% endif %}
  
  <div class="stat-card info">
    <h3>Ù…Ø±Ø¶Ù‰ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</h3>
    <p class="stat-value">{{ stats.total_clinic_patients|int }}</p>
  </div>
  
  <div class="stat-card success">
    <h3>Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</h3>
    <p class="stat-value">{{ stats.total_courses|int }}</p>
  </div>
  
  <div class="stat-card info">
    <h3>Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h3>
    <p class="stat-value">{{ stats.total_departments|int }}</p>
  </div>
  
  <div class="stat-card success">
    <h3>Ø§Ù„ÙƒÙ„ÙŠØ§Øª</h3>
    <p class="stat-value">{{ stats.total_colleges|int }}</p>
  </div>
</div>


{% if low_stock_drugs %}
<section class="table-section">
  <h3>âš ï¸ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø°Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ù…Ù†Ø®ÙØ¶</h3>
  <table class="data-table">
    <thead>
      <tr>
        <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ</th>
        <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…</th>
        <th>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©</th>
        <th>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰</th>
        <th>Ø§Ù„Ø´ÙƒÙ„</th>
        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
      </tr>
    </thead>
    <tbody>
      {% for drug in low_stock_drugs %}
      <tr>
        <td><strong>{{ drug.trade_name }}</strong></td>
        <td>{{ drug.generic_name or '-' }}</td>
        <td><strong style="color: #dc2626;">{{ drug.stock_qty }}</strong> {{ drug.unit }}</td>
        <td>{{ drug.reorder_level }}</td>
        <td>{{ drug.form or '-' }}</td>
        <td>
          <span class="badge {% if drug.is_active %}badge-active{% else %}badge-inactive{% endif %}">
            {% if drug.is_active %}Ù†Ø´Ø·{% else %}ØºÙŠØ± Ù†Ø´Ø·{% endif %}
          </span>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</section>
{% endif %}


<section class="table-section">
  <h3>ğŸ’Š Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ({{ all_drugs|length }})</h3>
  <table class="data-table">
    <thead>
      <tr>
        <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ</th>
        <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…</th>
        <th>Ø§Ù„Ù‚ÙˆØ©</th>
        <th>Ø§Ù„Ø´ÙƒÙ„</th>
        <th>Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</th>
        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
      </tr>
    </thead>
    <tbody>
      {% if all_drugs %}
        {% for drug in all_drugs %}
        <tr>
          <td><strong>{{ drug.trade_name }}</strong></td>
          <td>{{ drug.generic_name or '-' }}</td>
          <td>{{ drug.strength or '-' }}</td>
          <td>{{ drug.form or '-' }}</td>
          <td>
            <span>{{ drug.stock_qty }} {{ drug.unit }}</span>
            {% if drug.stock_qty <= drug.reorder_level %}
            <span class="badge badge-warning">Ù…Ù†Ø®ÙØ¶</span>
            {% endif %}
          </td>
          <td>
            <span class="badge {% if drug.is_active %}badge-active{% else %}badge-inactive{% endif %}">
              {% if drug.is_active %}Ù†Ø´Ø·{% else %}ØºÙŠØ± Ù†Ø´Ø·{% endif %}
            </span>
          </td>
        </tr>
        {% endfor %}
      {% else %}
      <tr>
        <td colspan="6" class="empty-message">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¯ÙˆÙŠØ©</td>
      </tr>
      {% endif %}
    </tbody>
  </table>
</section>


<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
  <section class="table-section">
    <h3>ğŸ¢ Ø§Ù„ÙƒÙ„ÙŠØ§Øª ({{ colleges|length }})</h3>
    <table class="data-table">
      <thead>
        <tr>
          <th>Ø§Ø³Ù… Ø§Ù„ÙƒÙ„ÙŠØ©</th>
          <th>Ø§Ù„Ø¹Ù…ÙŠØ¯</th>
          <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
        </tr>
      </thead>
      <tbody>
        {% if colleges %}
          {% for college in colleges %}
          <tr>
            <td><strong>{{ college.college_name or college.name or '-' }}</strong></td>
            <td>{{ college.dean_name or college.head_name or '-' }}</td>
            <td>{{ college.location or '-' }}</td>
          </tr>
          {% endfor %}
        {% else %}
        <tr>
          <td colspan="3" class="empty-message">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„ÙŠØ§Øª</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </section>
  
  <section class="table-section">
    <h3>ğŸ“‘ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ({{ departments|length }})</h3>
    <table class="data-table">
      <thead>
        <tr>
          <th>Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…</th>
          <th>Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…</th>
          <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
        </tr>
      </thead>
      <tbody>
        {% if departments %}
          {% for dept in departments %}
          <tr>
            <td><strong>{{ dept.department_name or dept.name or '-' }}</strong></td>
            <td>{{ dept.head_name or dept.manager_name or '-' }}</td>
            <td>{{ dept.location or '-' }}</td>
          </tr>
          {% endfor %}
        {% else %}
        <tr>
          <td colspan="3" class="empty-message">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‚Ø³Ø§Ù…</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </section>
</div>


<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
  <section class="table-section">
    <h3>ğŸ‘¥ Ø¹ÙŠÙ†Ø§Øª Ù…Ù† Ø§Ù„Ù…ØªØ¯Ø±Ø¨ÙŠÙ†</h3>
    <table class="data-table">
      <thead>
        <tr>
          <th>Ø±Ù‚Ù… Ø§Ù„Ù…ØªØ¯Ø±Ø¨</th>
          <th>Ø§Ù„Ø§Ø³Ù…</th>
          <th>Ø§Ù„ÙƒÙ„ÙŠØ©</th>
        </tr>
      </thead>
      <tbody>
        {% if sample_students %}
          {% for student in sample_students %}
          <tr>
            <td><strong>{{ student.student_id }}</strong></td>
            <td>{{ student.student_Name or '-' }}</td>
            <td>{{ student.College or '-' }}</td>
          </tr>
          {% endfor %}
        {% else %}
        <tr>
          <td colspan="3" class="empty-message">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØªØ¯Ø±Ø¨ÙŠÙ†</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </section>
  
  <section class="table-section">
    <h3>ğŸ¥ Ø¹ÙŠÙ†Ø§Øª Ù…Ù† Ù…Ø±Ø¶Ù‰ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</h3>
    <table class="data-table">
      <thead>
        <tr>
          <th>Ø±Ù‚Ù… Ø§Ù„Ù…ØªØ¯Ø±Ø¨</th>
          <th>Ø§Ù„Ø§Ø³Ù…</th>
          <th>Ø§Ù„Ø´ÙƒÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</th>
        </tr>
      </thead>
      <tbody>
        {% if sample_patients %}
          {% for patient in sample_patients %}
          <tr>
            <td><strong>{{ patient.trainee_no }}</strong></td>
            <td>{{ patient.full_name or '-' }}</td>
            <td>{{ patient.chief_complaint or '-' }}</td>
          </tr>
          {% endfor %}
        {% else %}
        <tr>
          <td colspan="3" class="empty-message">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±Ø¶Ù‰</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </section>
</div>


<section class="table-section" style="margin-top: 20px;">
  <h3>ğŸ”— ÙˆØ§Ø¬Ù‡Ø§Øª Ø¨Ø±Ù…Ø¬ÙŠØ© Ù…ØªØ§Ø­Ø© (APIs)</h3>
  <ul style="list-style: none; padding: 0;">
    <li style="margin-bottom: 10px;">
      <code style="background: #f0f4f8; padding: 5px 10px; border-radius: 5px;">/api/excel/statistics</code>
      - Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø©
    </li>
    <li style="margin-bottom: 10px;">
      <code style="background: #f0f4f8; padding: 5px 10px; border-radius: 5px;">/api/excel/drugs/all</code>
      - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©
    </li>
    <li style="margin-bottom: 10px;">
      <code style="background: #f0f4f8; padding: 5px 10px; border-radius: 5px;">/api/excel/drugs/low-stock</code>
      - Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø°Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ù…Ù†Ø®ÙØ¶
    </li>
    <li style="margin-bottom: 10px;">
      <code style="background: #f0f4f8; padding: 5px 10px; border-radius: 5px;">/api/excel/students/search?q=name</code>
      - Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ØªØ¯Ø±Ø¨ÙŠÙ†
    </li>
    <li style="margin-bottom: 10px;">
      <code style="background: #f0f4f8; padding: 5px 10px; border-radius: 5px;">/api/excel/colleges/all</code>
      - Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„ÙŠØ§Øª
    </li>
    <li style="margin-bottom: 10px;">
      <code style="background: #f0f4f8; padding: 5px 10px; border-radius: 5px;">/api/excel/departments/all</code>
      - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
    </li>
  </ul>
</section>

{% endblock %}
